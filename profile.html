<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Profile - KERALA ESPORTS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="data:,">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root { --p-green: #0fa958; --bg: #ffffff; --text: #333; }
body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding-bottom: 30px; }

/* LOADER STYLES */
#loader {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #ffffff; display: flex; justify-content: center; align-items: center;
    z-index: 10000;
}
.spinner {
    width: 40px; height: 40px;
    border: 4px solid #f3f3f3; border-top: 4px solid var(--p-green);
    border-radius: 50%; animation: spin 1s linear infinite;
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

/* Header & Profile Section */
.top-bar { display: flex; align-items: center; padding: 15px; font-weight: bold; font-size: 18px; border-bottom: 1px solid #f0f0f0; background: #fff; position: sticky; top: 0; z-index: 10; }
.top-bar i { margin-right: 15px; cursor: pointer; font-size: 20px; color: var(--p-green); }
.profile-main { text-align: center; padding: 30px 0; border-bottom: 8px solid #f9f9f9; animation: fadeIn 0.6s ease; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.profile-img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid var(--p-green); padding: 3px; background: #eee; }
.username-text { font-size: 20px; font-weight: bold; margin-top: 10px; color: #222; }

/* Menu List Styles */
.menu-group-label { padding: 15px 20px 8px; font-size: 12px; font-weight: bold; color: #999; text-transform: uppercase; letter-spacing: 1px; }
.menu-list { padding: 0 15px; }
.menu-item { 
    display: flex; align-items: center; justify-content: space-between;
    padding: 15px; border-radius: 12px; margin-bottom: 8px; cursor: pointer; background: #fff; border: 1px solid transparent; transition: 0.2s;
}
.menu-item:active { background: #f0f0f0; transform: scale(0.98); }
.menu-left { display: flex; align-items: center; gap: 15px; }
.menu-left i { font-size: 18px; color: #666; width: 20px; text-align: center; }
.menu-item span { font-weight: 500; font-size: 15px; color: #444; }
.arrow-right { color: #ccc; font-size: 12px; }

/* Logout Color */
.logout-item span, .logout-item i { color: #ff4d4d !important; }

/* MODAL (SLIDE-UP POPUP) */
.modal-overlay { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.5); z-index: 100; display: none; align-items: flex-end; 
}
.modal-content { 
    background: #fff; width: 100%; max-height: 80vh; border-radius: 25px 25px 0 0; 
    padding: 25px; box-sizing: border-box; overflow-y: auto; animation: slideUp 0.3s ease-out;
}
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
.modal-header h3 { margin: 0; color: var(--p-green); }
.close-modal { font-size: 20px; color: #888; cursor: pointer; }
.modal-body { line-height: 1.6; font-size: 14px; color: #555; }
.modal-body b { color: #333; display: block; margin-top: 15px; }

.version-info { text-align: center; color: #ccc; font-size: 11px; margin-top: 20px; padding-bottom: 20px; }
</style>
</head>
<body>

<div id="loader"><div class="spinner"></div></div>

<div class="top-bar">
    <i class="fa-solid fa-arrow-left" onclick="window.location.href='dashboard.html'"></i>
    Profile Settings
</div>

<div class="profile-main">
    <img id="userImg" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="profile-img">
    <div id="uName" class="username-text">Loading...</div>
    <div style="color:#888; font-size:12px;">Active Member</div>
</div>

<div class="menu-group-label">Tournament Tools</div>
<div class="menu-list">
    <div class="menu-item" onclick="location.href='settings.html'">
        <div class="menu-left"><i class="fa-regular fa-user"></i><span>Edit Profile</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <div class="menu-item" onclick="location.href='join-private.html'">
        <div class="menu-left"><i class="fa-solid fa-trophy"></i><span>Join Private Match</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
</div>

<div class="menu-group-label">Support & Legal</div>
<div class="menu-list">
    <div class="menu-item" onclick="openModal('faq')">
        <div class="menu-left"><i class="fa-regular fa-circle-question"></i><span>FAQs</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <div class="menu-item" onclick="openModal('about')">
        <div class="menu-left"><i class="fa-solid fa-circle-info"></i><span>About Us</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <div class="menu-item" onclick="location.href='privacy.html'">
        <div class="menu-left"><i class="fa-solid fa-user-shield"></i><span>Privacy Policy</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <div class="menu-item" onclick="openModal('terms')">
        <div class="menu-left"><i class="fa-solid fa-file-contract"></i><span>Terms & Conditions</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <div class="menu-item" onclick="window.open('https://t.me/keralaesport', '_blank')">
        <div class="menu-left"><i class="fa-brands fa-telegram"></i><span>Official Telegram Support</span></div>
        <i class="fa-solid fa-chevron-right arrow-right"></i>
    </div>
    <br>
    <div class="menu-item logout-item" onclick="logoutUser()">
        <div class="menu-left"><i class="fa-solid fa-arrow-right-from-bracket"></i><span>Logout</span></div>
    </div>
</div>

<div class="version-info">Version 1.0.3 | Kerala Esports</div>

<div id="infoModal" class="modal-overlay" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h3 id="modalTitle">Information</h3>
            <span class="close-modal" onclick="closeModal()">&times;</span>
        </div>
        <div id="modalBody" class="modal-body"></div>
    </div>
</div>

<script>
window.addEventListener("load", () => {
    setTimeout(() => { document.getElementById("loader").style.display = "none"; }, 600);
});

const firebaseConfig = {
 apiKey: "AIzaSyBrHcONT6y0he3fzrtRGqdQMZfIMpGxcNo",
 authDomain: "kl-esports.firebaseapp.com",
 databaseURL: "https://kl-esports-default-rtdb.firebaseio.com",
 projectId: "kl-esports",
 storageBucket: "kl-esports.appspot.com",
 messagingSenderId: "440301376580",
 appId: "1:440301376580:web:fb0b8ae0df3fe096bd1811"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

auth.onAuthStateChanged(user => {
    if(user) {
        db.ref("users").child(user.uid).on('value', snapshot => {
            const myData = snapshot.val();
            if(myData) {
                document.getElementById("uName").innerText = myData.username || "Gamer";
                document.getElementById("userImg").src = myData.profilePic || "https://cdn-icons-png.flaticon.com/512/149/149071.png";
            }
        });
    } else { 
        window.location.href = "index.html"; 
    }
});

const infoData = {
    faq: `<b>How do I join a match?</b><br>Go to home, select a match, and click JOIN.<br><br><b>How to withdraw?</b><br>Go to Wallet, enter UPI ID.<br><br><b>Hack Policy:</b><br>Permanent ban for hackers.`,
    about: `<b>Kerala Esports</b> is the #1 platform for FF enthusiasts in Kerala, founded in 2026. Our goal is to provide a fair and competitive environment.`,
    terms: `1. Must be 18+ to play.<br>2. Fair play only. Use of hacks will lead to ban.<br>3. No refunds after match starts.<br>4. Only one account per person is allowed.`
};

function openModal(type) {
    const titles = { faq: 'FAQs', about: 'About Us', terms: 'Terms & Conditions' };
    document.getElementById("modalTitle").innerText = titles[type];
    document.getElementById("modalBody").innerHTML = infoData[type];
    document.getElementById("infoModal").style.display = "flex";
}

function closeModal() { document.getElementById("infoModal").style.display = "none"; }

function logoutUser() {
    if(confirm("Are you sure you want to logout?")) {
        auth.signOut().then(() => { 
            window.location.href = "index.html"; 
        }).catch(err => {
            alert("Logout Error: " + err.message);
        });
    }
}
</script>
</body>
</html>
